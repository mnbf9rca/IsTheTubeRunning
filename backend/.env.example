# example@v1
# IsTheTubeRunning - Environment Configuration
# Copy this file to .env and fill in your actual values

# ============================================================================
# API Settings
# ============================================================================
API_V1_PREFIX=/api/v1
PROJECT_NAME=IsTheTubeRunning
DEBUG=false
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# ============================================================================
# Logging Settings
# ============================================================================
# Log level for application logging (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# ============================================================================
# Database Settings (PostgreSQL)
# ============================================================================
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/isthetube
DATABASE_ECHO=false

# Test Database (optional - defaults to isthetube_test if not set)
# TEST_DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/isthetube_test

# ============================================================================
# Redis Settings
# ============================================================================
REDIS_URL=redis://localhost:6379/0

# ============================================================================
# Auth0 Settings (Phase 3)
# ============================================================================
AUTH0_DOMAIN=your-tenant.auth0.com
AUTH0_API_AUDIENCE=https://your-api-audience
AUTH0_ALGORITHMS=RS256

# ============================================================================
# TfL API Settings (Phase 5)
# ============================================================================
# Get your API key from: https://api.tfl.gov.uk
TFL_API_KEY=your-tfl-api-key-here

# ============================================================================
# Email Settings (Phase 4)
# SMTP configuration for sending verification emails
# ============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_EMAIL=noreply@isthetuberunning.com
# TLS auto-detected: port 465=implicit TLS, port 587/25=STARTTLS
# Set to true to require STARTTLS upgrade (fails if not supported)
# SMTP_REQUIRE_TLS=false

# ============================================================================
# Celery Settings (Phase 8)
# ============================================================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# ============================================================================
# Alert Settings (Issue #309)
# ============================================================================
# Per-line cooldown in minutes to prevent spam from TfL API flickering
# If only the reason text changes (not severity/status), wait this long before re-alerting
ALERT_COOLDOWN_MINUTES=5

# ============================================================================
# PII Hashing Settings (Issue #311)
# ============================================================================
# Secret key for HMAC-SHA256 hashing of PII (emails/phones) in logs and telemetry
# Generate a strong random secret: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
PII_HASH_SECRET=REPLACE_ME_WITH_RANDOM_SECRET

# ============================================================================
# Frontend Settings
# ============================================================================
VITE_API_URL=http://localhost:8000

# ============================================================================
# OpenTelemetry Settings (Observability)
# ============================================================================
# Master switch for OpenTelemetry distributed tracing
OTEL_ENABLED=true

# Service identification
# Default service name - can be overridden per component for service graph differentiation:
#   - FastAPI/Backend: isthetuberunning-api
#   - Celery Worker: isthetuberunning-worker
#   - Celery Beat: isthetuberunning-beat
OTEL_SERVICE_NAME="isthetuberunning-backend"
OTEL_ENVIRONMENT="production"

# Grafana Cloud OTLP endpoints (get from Grafana Cloud dashboard)
# Separate endpoints for traces and logs
# Format: https://otlp-gateway-{region}.grafana.net/otlp/v1/{signal}
OTEL_EXPORTER_OTLP_TRACES_ENDPOINT="https://otlp-gateway-prod-us-central-0.grafana.net/otlp/v1/traces"
OTEL_EXPORTER_OTLP_LOGS_ENDPOINT="https://otlp-gateway-prod-us-central-0.grafana.net/otlp/v1/logs"

# Grafana Cloud auth header (same for traces and logs)
# Format: Authorization=Basic <base64-encoded-credentials>
OTEL_EXPORTER_OTLP_HEADERS="Authorization=Basic <your-base64-credentials>"

# Protocol format for OTLP exports
OTEL_EXPORTER_OTLP_PROTOCOL="http/protobuf"

# Sampling configuration (1.0 = 100% sampling, 0.1 = 10% sampling)
OTEL_TRACES_SAMPLER="parentbased_always_on"
OTEL_TRACES_SAMPLER_ARG=1.0

# Log level for OTLP log export
# Valid values: NOTSET (all logs), DEBUG, INFO, WARNING, ERROR, CRITICAL
# NOTSET exports all log levels to Grafana Cloud for maximum observability
OTEL_LOG_LEVEL="NOTSET"

# Exclude health check endpoints from tracing (comma-separated)
OTEL_EXCLUDED_URLS="/health,/ready,/metrics"

# ============================================================================
# Production Settings (Phase 12)
# ============================================================================
# Sentry DSN for error tracking
# SENTRY_DSN=https://your-sentry-dsn

# Azure Blob Storage for backups
# AZURE_STORAGE_CONNECTION_STRING=your-connection-string
# AZURE_STORAGE_CONTAINER=backups
